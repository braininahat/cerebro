# EEGNeX Challenge 1 Supervised Baseline - Smoke Test (20 steps)
seed_everything: 42
run_lr_finder: false
run_batch_size_finder: false

trainer:
  max_steps: 20
  val_check_interval: 10
  accelerator: auto
  devices: 1
  precision: bf16-mixed
  gradient_clip_val: 1.0
  deterministic: true
  log_every_n_steps: 5
  
  logger:
    class_path: lightning.pytorch.loggers.WandbLogger
    init_args:
      project: eeg2025
      entity: ubcse-eeg2025
      name: eegnex_c1_smoke
      tags: [eegnex, challenge1, supervised, smoke]
      save_dir: outputs/supervised_eegnex_c1_smoke
      mode: offline
  
  callbacks:
    - class_path: lightning.pytorch.callbacks.ModelCheckpoint
      init_args:
        dirpath: outputs/supervised_eegnex_c1_smoke/checkpoints
        filename: c1-{epoch:02d}-{val_nrmse:.4f}
        monitor: val_nrmse
        mode: min
        save_top_k: 1
        save_last: true
    - class_path: lightning.pytorch.callbacks.TQDMProgressBar
      init_args:
        leave: true

model:
  class_path: cerebro.trainers.supervised.SupervisedTrainer
  init_args:
    model:
      class_path: cerebro.models.architectures.RegressorModel
      init_args:
        encoder_class: EEGNeX
        n_outputs: 1
        dropout: 0.25
        input_scale: 1000.0
        encoder_kwargs:
          n_chans: 129
          n_times: 200
          sfreq: 100
    loss_fn: mse
    lr: 0.001
    weight_decay: 0.00001
    epochs: 2
    warmup_epochs: 0

data:
  class_path: cerebro.data.challenge1.Challenge1DataModule
  init_args:
    data_dir: ${oc.env:EEG2025_DATA_ROOT,data}
    releases: [R1]
    batch_size: 512
    num_workers: 4
    window_len: 2.0
    shift_after_stim: 0.5
    sfreq: 100
    val_frac: 0.1
    test_frac: 0.1
    seed: 2025
    excluded_subjects: []
